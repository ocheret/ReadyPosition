<project name="Collections">
  <import file="../common.xml"/>

  <property name="pkg.dir" value="${pkg.root.dir}/collections"/>
  <property name="src.pkg.dir" value="${src.dir}/${pkg.dir}"/>
  <property name="gen.pkg.dir" value="${gen.dir}/${pkg.dir}"/>

  <macrodef name="generateKeyType">
    <attribute name="keyName"/>
    <attribute name="keyType"/>
    <attribute name="package"/>
    <attribute name="fileBase"/>
    <sequential>
      <copy file="${src.pkg.dir}/@{package}/@{fileBase}_KeyName_.java"
            toFile="${gen.pkg.dir}/@{package}/@{fileBase}@{keyName}.java">
        <filterset begintoken="_" endtoken="_">
          <filter token="KeyName" value="@{keyName}"/>
          <filter token="KeyType" value="@{keyType}"/>
          <filter token="Warning"
                  value="***** DO NOT EDIT: Generated from template *****"/>
        </filterset>
      </copy>
    </sequential>
  </macrodef>

  <macrodef name="generateValueType">
    <attribute name="valueName"/>
    <attribute name="valueType"/>
    <attribute name="package"/>
    <attribute name="fileBase"/>
    <sequential>
      <copy file="${src.pkg.dir}/@{package}/@{fileBase}_ValueName_.java"
            toFile="${gen.pkg.dir}/@{package}/@{fileBase}@{valueName}.java">
        <filterset begintoken="_" endtoken="_">
          <filter token="ValueName" value="@{valueName}"/>
          <filter token="ValueType" value="@{valueType}"/>
          <filter token="Warning"
                  value="***** DO NOT EDIT: Generated from template *****"/>
        </filterset>
      </copy>
    </sequential>
  </macrodef>

  <macrodef name="generateKeyValueType">
    <attribute name="keyName"/>
    <attribute name="keyType"/>
    <attribute name="valueName"/>
    <attribute name="valueType"/>
    <attribute name="package"/>
    <attribute name="fileBase"/>
    <sequential>
      <copy file="${src.pkg.dir}/@{package}/@{fileBase}_KeyName__ValueName_.java"
            toFile="${gen.pkg.dir}/@{package}/@{fileBase}@{keyName}@{valueName}.java">
        <filterset begintoken="_" endtoken="_">
          <filter token="KeyName" value="@{keyName}"/>
          <filter token="KeyType" value="@{keyType}"/>
          <filter token="ValueName" value="@{valueName}"/>
          <filter token="ValueType" value="@{valueType}"/>
          <filter token="Warning"
                  value="***** DO NOT EDIT: Generated from template *****"/>
        </filterset>
      </copy>
    </sequential>
  </macrodef>

  <macrodef name="generateValueTypes">
    <attribute name="valueName"/>
    <attribute name="valueType"/>
    <sequential>
      <!-- common -->
      <generateValueType valueName="@{valueName}" valueType="@{valueType}"
                         package="common" fileBase="MapG"/>
      <!-- comparator -->
      <generateValueType valueName="@{valueName}" valueType="@{valueType}"
                         package="comparator" fileBase="Cmp"/>
      <generateValueType valueName="@{valueName}" valueType="@{valueType}"
                         package="comparator" fileBase="Eq"/>
      <generateValueType valueName="@{valueName}" valueType="@{valueType}"
                         package="comparator" fileBase="Comparator"/>
    </sequential>
  </macrodef>

  <macrodef name="generateKeyValueTypes">
    <attribute name="keyName"/>
    <attribute name="keyType"/>
    <attribute name="valueName"/>
    <attribute name="valueType"/>
    <sequential>
      <!-- common -->
      <generateKeyValueType keyName="@{keyName}" keyType="@{keyType}"
                            valueName="@{valueName}" valueType="@{valueType}"
                            package="common" fileBase="Map"/>
    </sequential>
  </macrodef>

  <macrodef name="generateKeyTypes">
    <attribute name="keyName"/>
    <attribute name="keyType"/>
    <sequential>
      <!-- common -->
      <generateKeyType keyName="@{keyName}" keyType="@{keyType}"
                       package="common" fileBase="Set"/>

      <!-- Nested generation of KeyValue types -->
      <generateKeyValueTypes keyName="@{keyName}" keyType="@{keyType}"
                             valueName="Char" valueType="char"/>
      <generateKeyValueTypes keyName="@{keyName}" keyType="@{keyType}"
                             valueName="Byte" valueType="byte"/>
      <generateKeyValueTypes keyName="@{keyName}" keyType="@{keyType}"
                             valueName="Short" valueType="short"/>
      <generateKeyValueTypes keyName="@{keyName}" keyType="@{keyType}"
                             valueName="Int" valueType="int"/>
      <generateKeyValueTypes keyName="@{keyName}" keyType="@{keyType}"
                             valueName="Long" valueType="long"/>
      <generateKeyValueTypes keyName="@{keyName}" keyType="@{keyType}"
                             valueName="Float" valueType="float"/>
      <generateKeyValueTypes keyName="@{keyName}" keyType="@{keyType}"
                             valueName="Double" valueType="double"/>
      <generateKeyValueTypes keyName="@{keyName}" keyType="@{keyType}"
                             valueName="Object" valueType="Object"/>
    </sequential>
  </macrodef>

  <target name="generate" depends="init">
    <mkdir dir="${gen.dir}"/>
    <generateValueTypes valueName="Char" valueType="char"/>
    <generateValueTypes valueName="Byte" valueType="byte"/>
    <generateValueTypes valueName="Short" valueType="short"/>
    <generateValueTypes valueName="Int" valueType="int"/>
    <generateValueTypes valueName="Long" valueType="long"/>
    <generateValueTypes valueName="Float" valueType="float"/>
    <generateValueTypes valueName="Double" valueType="double"/>
    <generateValueTypes valueName="Object" valueType="Object"/>

    <generateKeyTypes keyName="Char" keyType="char"/>
    <generateKeyTypes keyName="Byte" keyType="byte"/>
    <generateKeyTypes keyName="Short" keyType="short"/>
    <generateKeyTypes keyName="Int" keyType="int"/>
    <generateKeyTypes keyName="Long" keyType="long"/>
    <generateKeyTypes keyName="Float" keyType="float"/>
    <generateKeyTypes keyName="Double" keyType="double"/>
    <generateKeyTypes keyName="Object" keyType="Object"/>
  </target>

</project>
